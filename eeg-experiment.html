<!DOCTYPE html>
<html>
  <head>
    <title>Card Betting Task</title>
    <script src=jspsych/jspsych.js></script>
    <script src=jspsych/plugin-html-keyboard-response.js></script>
    <script src=jspsych/plugin-image-keyboard-response.js></script>
    <script src=jspsych/plugin-preload.js></script>
    <link href="jspsych/jspsych.css" rel="stylesheet" type="text/css"/>
  </head>

  <style>
    p {color: #5A5A5A; font-size: 20px;}
    .RED {color: red; font-weight: bold;}
    .BLACK {color: black; font-weight: bold;}
    .fixation {color: #5A5A5A; font-size: 60px; font-weight: bold;}
    .choice_container div {width: 200px; height: 100px; font-size: 60px;}
    .card_deck
    {
        margin: 0;
        position: fixed;
        display: flex;
        justify-content: center;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
        width: 400px;
        height: 400px;
        border-radius: 100%;
    }
    .card
    {
        position: absolute;
        top: 50%;
        width: 80px;
        height: 100px;
        background: grey;
    }
    .deg-0 {transform: translateY(-200px)}
    .deg-72 {transform: rotate(72deg) translateY(-150px) rotate(-72deg) translateY(-50px)}
    .deg-144 {transform: rotate(144deg) translateY(-150px) rotate(-144deg) translateY(-50px)}
    .deg-216 {transform: rotate(216deg) translateY(-150px) rotate(-216deg) translateY(-50px)}
    .deg-288 {transform: rotate(288deg) translateY(-150px) rotate(-288deg) translateY(-50px)}
  </style>

  <body></body>

  <script>
    // Set up -----------------------------------------------------------------------------------------------------------------------
    
    /* initiate jsPsych trial */
    var jsPsych = initJsPsych
    ({
      on_finish: function()
      {jsPsych.data.displayData();}
    });

    /* declare vars here */
    var timeline = [];

    // Reusable trial blocks ========================================================================================================
    
    /* choice trial */
    var choice =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus:
      `
        <div class="choice_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
          <div class="RED" style="text-align: right;">RED</div>
          <div class="fixation">+</div>
          <div class="BLACK" style="text-align: left;">BLACK</div>
        </div>
      `,
      choices: ['ArrowLeft', 'ArrowRight'],
      data:
      {task: 'response'}
    };

    /* generate card sequence */
    function cardColorSeqGen()
    {
      var colorArr = [5];

      for (var i=0; i<5; i++)
      {colorArr[i] = Math.round(Math.random());}

      return colorArr;
    };

    /* trial card reveal sequence */
    var trial_card_reveal = {
      timeline: [
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: grey"></div>
              <div class ="card deg-72" style="background: grey"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
          return html;},
          choices: "NO_KEYS",
          trial_duration: 2000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: grey"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus:function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: ${jsPsych.timelineVariable('card3')}"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: ${jsPsych.timelineVariable('card3')}"></div>
              <div class ="card deg-216" style="background: ${jsPsych.timelineVariable('card4')}"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: ${jsPsych.timelineVariable('card3')}"></div>
              <div class ="card deg-216" style="background: ${jsPsych.timelineVariable('card4')}"></div>
              <div class ="card deg-288" style="background: ${jsPsych.timelineVariable('card5')}"></div>
            </div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        }
      ],
      timeline_variables :[
        {card1: "red", card2: "red", card3: "red", card4: "black", card5: "black"}
      ],
    };
    
    // Welcome + practice trials ====================================================================================================
    
    /* welcome instructions */
    var welcome_instructions =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus:
      `
        <p>Welcome and thank you for participating in this study!</p>
        <br>
        <p>In each trial, you will predict whether there will be more
            <span class="RED">RED</span> or
            <span class="BLACK">BLACK</span> cards.</p>
        <p>Afterwards, on the next slide, a deck of 5 cards will appear.</p>
        <br>
        <p>Each card has a 50% chance of appearing as either color.</p>
        <p>If you correctly predicted the color of most of the cards, you win the round.</p>
        <p>Otherwise, you lose the round.</p>
        <br>
        <p>The next few slides will serve as a tutorial.</p>
        <br>
        <p>Press any key to move on to the next slide.</p>
      `,
      post_trial_gap: 100
    };

    /* practice round instructions */
    var practice_instructions =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus:
      `
        <p>We will now go through <strong>2</strong> practice rounds.</p>
        <p>On the next slide, you will see the words
          “<span class="RED">RED</span>” and
          “<span class="BLACK">BLACK</span>”.</p>
        <p>Click ← on your keyboard to choose
          “<span class="RED">RED</span>” or → to choose
          “<span class="BLACK">BLACK</span>”.</p>
        <br>
        <p>Please try to stay focused on the fixation cross in the center and reduce blinking during trials.</p>
        <p>Press any key to move on to the next slide.</p>
      `,
      post_trial_gap: 100
    };

    /* practice choice trial */
    var practice_choice =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus:
      `
        <div class="choice_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
          <div class="RED" style="text-align: right;">RED</div>
          <div class="fixation">+</div>
          <div class="BLACK" style="text-align: left;">BLACK</div>
        </div>
      `,
      choices: ['ArrowLeft', 'ArrowRight'],
      data:
      {
        task: 'practice_response',
        correct_response: 'ArrowLeft'
      },
      on_finish: function(data)
      {
        data.correct = jsPsych.pluginAPI.compareKeys(data.response, data.correct_response);
      }
    };

    /* practice round post-choice instruction */
    var practice_post_choice_instructions =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus:
      `
        <p>Great!</p>
        <p>On the following slide, you will see a deck of 5 cards.</p>
        <p>The color of each card will be revealed one by one. You will not need to press any keys.</p>
        <br>
        <p>If more cards in the deck are in your chosen color than the other color, you win this round.</p>
        <p>Otherwise, you lose this round.</p>
      `,
      post_trial_gap: 100
    };

    /* practice trial card reveal */
    var practice_card_reveal =
    {
      timeline:
      [
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function()
          {
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: grey"></div>
              <div class ="card deg-72" style="background: grey"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
          return html;
          },
          choices: "NO_KEYS",
          trial_duration: 2000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function()
          {
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: red"></div>
              <div class ="card deg-72" style="background: grey"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;
          },
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function()
          {
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: red"></div>
              <div class ="card deg-72" style="background: red"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;
          },
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus:function()
          {
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: red"></div>
              <div class ="card deg-72" style="background: red"></div>
              <div class ="card deg-144" style="background: red"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;
          },
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function()
          {
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: red"></div>
              <div class ="card deg-72" style="background: red"></div>
              <div class ="card deg-144" style="background: red"></div>
              <div class ="card deg-216" style="background: black"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>`;
            return html;
          },
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function()
          {
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: red"></div>
              <div class ="card deg-72" style="background: red"></div>
              <div class ="card deg-144" style="background: red"></div>
              <div class ="card deg-216" style="background: black"></div>
              <div class ="card deg-288" style="background: black"></div>
            </div>`;
            return html;
          },
          choices: "NO_KEYS",
          trial_duration: 3000
        }
      ],
    };

    function correctResponseCount(dataTag) 
    {
      var response = jsPsych.data.get().filter({task: dataTag});
      var correct_responses = response.filter({correct: true});
      return correct_responses.count();
    };

    /* practice guided trial end instructions */
    var practice_guided_trial_end_instructions =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: function()
      {
        var practice_correct_responses = correctResponseCount('practice_response')
        var retHtml;

        if (practice_correct_responses >= 1)
        {
          retHtml =
          `
          <p>Well done!</p>
          <br>
          <p>The next practice trial will be identical to the previous, but you will not be given any instructions.</p>
          <br>
          <p>Please stay focused on the fixation point “<strong>+</strong>” at the center and blink as little as possible.</p>
          `;
        }
        else
        {
          retHtml =
          `
          <p>Whoops, better luck next time!</p>
          <br>
          <p>The next practice trial will be identical to the previous, but you will not be given any instructions.</p>
          <br>
          <p>Please stay focused on the fixation point “<strong>+</strong>” at the center and blink as little as possible.</p>
          `;
        }
        return retHtml;
      },
      post_trial_gap: 100
    };

    /* 2 practice trials */
    // TODO: practice_guided_trial_end_instructions isn't showing up after result_deck
    var practice_procedure =
    {
      timeline:   [practice_instructions,
                  practice_choice,
                  practice_post_choice_instructions,
                  practice_card_reveal,
                  practice_guided_trial_end_instructions]
    };
    // Practice trials end ==========================================================================================================

    //  test trials ========================================================================================================

    /* initialize trial number & money */
    var trial_number = 1;
    var money = 10;

    /* initialize color container
    color[0] is the winning color
    color[1] is the losing color */
    var color = [2];

    /* initialize the equal win/lose sequence for the 80 test runs 
    0 represent win condition
    1 represent lose condition
    */
    function shuffle(array) { // array shuffle algorithm
      let currentIndex = array.length,  randomIndex;
        while (currentIndex != 0) {
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex--;
      [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
      }
      return array;
    }

    function equalOutcome(){ // shuffled array of 40 "1" and 40 "0"
      var outcome = [80];
      for (var i=0; i<=39; i++){
        outcome [i] = 0 ;
      }
      for (var i = 40 ; i<=79; i++){
        outcome [i] = 1 ;
      }
      shuffle(outcome);
      return outcome;
    }

    var final_outcome = equalOutcome();

    /* starting page */
    /** can not update trial number right now **/
    /** need to change the font to be consistant with the rest of the slide **/
    var trial_info = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: function(){
        return `
        <div class="info_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
          <div class="trial" style="text-align: center;"><p>Trial ${trial_number}</p><p>Make your prediction on the next slide.</p></div>
        </div>
      `},
      choices: "NO_KEYS",
      trial_duration: 3000
    }

    /* choice trial page */ 
    var choice =
    {
      type: jsPsychHtmlKeyboardResponse,
      stimulus:
      `
        <div class="choice_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
          <div class="RED" style="text-align: right;">RED</div>
          <div class="fixation">+</div>
          <div class="BLACK" style="text-align: left;">BLACK</div>
        </div>
      `,
      choices: ['ArrowLeft', 'ArrowRight'], //left -> red, right -> black
      data: {task: 'response'},
      on_finish: function(data){ // push corresponding color to the color container ** can not update the color variable **
        if (jsPsych.pluginAPI.compareKeys(data.response, 'ArrowLeft')){
          data.color = 'red';
        }
        else {
          data.color = 'black';
        }
        if (final_outcome[trial_number] == 0){ // winning condition
          if (data.color == 'red'){
            color.push('red');
            color.push('black');
          }
          else {
            color.push('black');
            color.push('red');
          }
        }
        else { // losing condition
          if (data.color == 'red'){
            color.push('black');
            color.push('red');
          }
          else {
            color.push('red');
            color.push('black');
          }
        }
      }
    }

    /* choice infromation screen */ 
    /** need to change the font to be consistant with the rest of the slide **/
    var choice_info = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: function(){
        var pchoice = jsPsych.data.get().last(1).values()[0].color;
        return`
        <div class="choice_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
          <div class="trial" style="text-align: center;"><p>Chosen Option: ${pchoice}</p></div>
        </div>
      `},
      choices: "NO_KEYS",
      trial_duration: 2000
    }

    /* card combination 
    */ 
    var card_comb = [
      {card1: color[0], card2: color[0], card3: color[0], card4: color[0], card5: color[0]},
      {card1: color[1], card2: color[0], card3: color[0], card4: color[0], card5: color[0]},
      {card1: color[0], card2: color[1], card3: color[0], card4: color[0], card5: color[0]},
      {card1: color[0], card2: color[0], card3: color[1], card4: color[0], card5: color[0]},
      {card1: color[0], card2: color[0], card3: color[0], card4: color[1], card5: color[0]},
      {card1: color[0], card2: color[0], card3: color[0], card4: color[0], card5: color[1]},
      {card1: color[1], card2: color[1], card3: color[0], card4: color[0], card5: color[0]},
      {card1: color[1], card2: color[0], card3: color[1], card4: color[0], card5: color[0]},
      {card1: color[1], card2: color[0], card3: color[0], card4: color[1], card5: color[0]},
      {card1: color[1], card2: color[0], card3: color[0], card4: color[0], card5: color[1]},
      {card1: color[0], card2: color[1], card3: color[1], card4: color[0], card5: color[0]},
      {card1: color[0], card2: color[1], card3: color[0], card4: color[1], card5: color[0]},
      {card1: color[0], card2: color[1], card3: color[0], card4: color[0], card5: color[1]},
      {card1: color[0], card2: color[0], card3: color[1], card4: color[1], card5: color[0]},
      {card1: color[0], card2: color[0], card3: color[1], card4: color[0], card5: color[1]},
      {card1: color[0], card2: color[0], card3: color[0], card4: color[1], card5: color[1]},
    ]

    /* card reveal sequence */
    /** can not recieve updated color container **/
    var card_reveal = {
      timeline: [ // card reveal sequence
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: grey"></div>
              <div class ="card deg-72" style="background: grey"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>
            <div class="fixation">+</div>`;
          return html;},
          choices: "NO_KEYS",
          trial_duration: 2000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: grey"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>
            <div class="fixation">+</div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: grey"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>
            <div class="fixation">+</div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus:function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: ${jsPsych.timelineVariable('card3')}"></div>
              <div class ="card deg-216" style="background: grey"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>
            <div class="fixation">+</div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: ${jsPsych.timelineVariable('card3')}"></div>
              <div class ="card deg-216" style="background: ${jsPsych.timelineVariable('card4')}"></div>
              <div class ="card deg-288" style="background: grey"></div>
            </div>
            <div class="fixation">+</div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
          
        },
        {
          type: jsPsychHtmlKeyboardResponse,
          stimulus: function(){
            var html = 
            `<div class ="card_deck">
              <div class ="card deg-0" style="background: ${jsPsych.timelineVariable('card1')}"></div>
              <div class ="card deg-72" style="background: ${jsPsych.timelineVariable('card2')}"></div>
              <div class ="card deg-144" style="background: ${jsPsych.timelineVariable('card3')}"></div>
              <div class ="card deg-216" style="background: ${jsPsych.timelineVariable('card4')}"></div>
              <div class ="card deg-288" style="background: ${jsPsych.timelineVariable('card5')}"></div>
            </div>
            <div class="fixation">+</div>`;
            return html;},
          choices: "NO_KEYS",
          trial_duration: 3000
        }
      ],
      timeline_variables : card_comb,
      sample: {
        type: "without-replacement",
        size: 1
      }
    };

    /* result page */
    /** can not update money and trial_number **/
    var result_page = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: function(){
        if (final_outcome[trial_number] == 0){
          money += 0.2;
          return `
          <div class="info_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
            <div class="trial" style="text-align: center;">
              <p>Won 20 cents!</p>
              <p>Total amount won:</p>
              <p>$${money}</p></div>
          </div>`
        }
        if (final_outcome[trial_number] == 1){
          return `
          <div class="info_container" style="position: relative; margin: auto; display: flex; justify-content: space-between;">
            <div class="trial" style="text-align: center;">
              <p>Lost this Round.</p>
              <p>Total amount won:</p>
              <p>$${money}</p></div>
          </div>`
        }
      },
      choices: "NO_KEYS",
      trial_duration: 2000,
      on_finish: function(){
        tiral_number =+ 1;
      }
    }

    /* test run timeline */
    var test_proc = {
      timeline: [
        trial_info,
        choice,
        choice_info,
        card_reveal,
        result_page
      ],
      repetitions: 16 // one block
    }

    // test trials end ========================================================================================================

    
    // [TUT CODE] to show at end of trials. gives info on how participant did.
    var debrief_block = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: function() {
        var trials = jsPsych.data.get().filter({task: 'response'}); // getting # of response trials
        var correct_trials = trials.filter({correct: true}); // filtering for correct for # correct answers
        var accuracy = Math.round(correct_trials.count() / trials.count() * 100); // proportion
        var rt = Math.round(correct_trials.select('rt').mean()); // mean reaction time

        return `<p>You responded correctly on ${accuracy}% of the trials.</p>
      <p>Your average response time was ${rt}ms.</p>
      <p>Press any key to complete the experiment. Thank you!</p>`;
      }
    };

    // Timeline push and run --------------------------------------------------------------------------------------------------------
    timeline.push(welcome_instructions);
    timeline.push(practice_procedure);
    timeline.push(test_proc);
    //timeline.push(debrief_block);
    jsPsych.run(timeline); // run it all!
  </script>
</html>
